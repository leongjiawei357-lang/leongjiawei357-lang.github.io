<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Edit Inventory | Inventory System</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>ðŸ“¦ Edit Inventory Item</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="inventory.html">Inventory</a>
      <a href="documents.html">Documents</a>
      <a href="log.html">Activity Log</a>
      <button onclick="toggleTheme()">ðŸŒ“ Mode</button>
      <button onclick="logout()">ðŸšª Logout</button>
      <div id="adminInfo">Logged in as: <span id="adminName"></span></div>
    </nav>
  </header>

  <section>
    <h2 id="formTitle">Add / Edit Item</h2>
    <form id="inventoryForm">
      <label>SKU</label>
      <input type="text" id="sku" placeholder="Enter SKU" required />
      
      <label>Name</label>
      <input type="text" id="name" placeholder="Enter item name" required />
      
      <label>Quantity</label>
      <input type="number" id="quantity" placeholder="Enter quantity" required />
      
      <label>Category</label>
      <input type="text" id="category" placeholder="Enter category" required />
      
      <button type="submit" id="saveBtn">ðŸ’¾ Save</button>
      <button type="button" id="deleteBtn" style="background: #e84118;">ðŸ—‘ Delete</button>
      <button type="button" onclick="window.location.href='inventory.html'">â¬… Back</button>
    </form>
  </section>

  <script>
    let inventory = JSON.parse(localStorage.getItem("inventoryData")) || [];
    let currentIndex = null;

    // Pre-fill form if editing
    const params = new URLSearchParams(window.location.search);
    if (params.has("index")) {
      currentIndex = parseInt(params.get("index"));
      const item = inventory[currentIndex];
      if (item) {
        document.getElementById("sku").value = item.sku;
        document.getElementById("name").value = item.name;
        document.getElementById("quantity").value = item.quantity;
        document.getElementById("category").value = item.category;
        document.getElementById("formTitle").textContent = "Edit Item";
      }
    }

    document.getElementById("inventoryForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const sku = document.getElementById("sku").value.trim();
      const name = document.getElementById("name").value.trim();
      const quantity = parseInt(document.getElementById("quantity").value, 10);
      const category = document.getElementById("category").value.trim();

      if (!sku || !name || isNaN(quantity) || !category) return alert("âš ï¸ Please fill all fields.");

      if (currentIndex !== null) {
        inventory[currentIndex] = { sku, name, quantity, category };
        alert("âœ… Item updated successfully!");
      } else {
        inventory.push({ sku, name, quantity, category });
        alert("âœ… Item added successfully!");
      }
      localStorage.setItem("inventoryData", JSON.stringify(inventory));
      window.location.href = "inventory.html";
    });

    document.getElementById("deleteBtn").addEventListener("click", function() {
      if (currentIndex === null) return alert("âš ï¸ No item to delete.");
      if (confirm("Delete this item?")) {
        inventory.splice(currentIndex, 1);
        localStorage.setItem("inventoryData", JSON.stringify(inventory));
        window.location.href = "inventory.html";
      }
    });

    // Display admin name
    document.getElementById("adminName").textContent = localStorage.getItem("adminName") || "Admin";

    function logout() {
      localStorage.removeItem("isLoggedIn");
      window.location.href = "login.html";
    }

    function toggleTheme() {
      document.body.classList.toggle("dark-mode");
      localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
    }

    window.onload = () => {
      const theme = localStorage.getItem("theme");
      if (theme === "dark") document.body.classList.add("dark-mode");
    };
  </script>
</body>
</html>
